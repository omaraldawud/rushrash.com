// JavaScript Document
$(document).ready(function() {
/*document STAR*/

     /*設定螢幕寬高值*/
       var  $winW = $(window).width(),
            $winH = $(window).height(),
            $body = $("body"),
            $html = $("html"),
            $win = $(window),
            $htmlBody = $("html , body"),
            $header =  $('header'),
            $footer = $('footer'),
            $navbarToggle = $(".navbar-toggle"),
            $Top = $(".Top"),
            $headerLi = $header.find(".navbar-left li"),
            $dropdown = $header.find(".navbar-right .dropdown");


    /* ===========================================================
        base
    =============================================================*/

        firstCss();
        function firstCss() {
            setTimeout(function() {
                $('body').addClass("start");
            }, 200);
        } //end firstCss()

        //Top
        $Top.click(function(){
            $htmlBody.stop(true,false).animate({scrollTop:0},500,"easeOutCirc");
            return false;   
        });

        $(window).scroll(function() {
            //Top
            if ( $(this).scrollTop() > 400){
                
                $Top.fadeIn("fast");

            } else {
                $Top.stop().fadeOut(300);
            }

            if ( $(this).scrollTop() > 79){
                $headerLi.removeClass("open");
            }
        });

        //let 
        $headerLi.mouseover(function(){
          $dropdown.removeClass("open");
        });

        var $classMenu = $header.find('.classMenu'),
            $classLi = $classMenu.find('li'),
            $productMenu = $header.find('.productMenu'),
            $Product  =  $header.find('#Product');

        $productMenu.fadeOut();
        $classLi.eq(0).find("ul").fadeIn();
   

        $Product.hover(
            function() {
                $(this).addClass("open");
                //$classMenu.fadeIn();
                $classLi.eq(0).find("ul").fadeIn(100);
            }, function() {
                $(this).removeClass("open");
                //$classMenu.fadeOut(100);
            }
        );
       
        //smartmenus();
        $('#mainNav').smartmenus();
 
        //placeholder 支援 ie9
        $('input, textarea').placeholder();

        //img focus 
         $('.focuspoint').focusPoint();

        //img center
        $(".imgLiquidFill").imgLiquid({
            fill: true,
            horizontalAlign: "center",
            verticalAlign: "top"
        });

        $navbarToggle.click(function() {
            $(this).toggleClass("active");
        });

        //wow
        wow = new WOW({
            boxClass:     'wow',      // default
            animateClass: 'animated', // default
            offset:       30,          // default
            mobile:       true,       // default
            live:         true        // default
        })
        wow.init();

        $('.single_img').fancybox({
            openEffect  : 'elastic',
            closeEffect : 'elastic',
            helpers: {
			  title: null	
              //title : {
                  //type : 'float'
				  
              //}
            }
        });


    /* ============================================
        首頁
    ===============================================*/
    var $home = $("#home");
    $home.each(function () { 

        var $indexBanner = $home.find(".indexBannerSilder"),
            $newsSilder = $home.find(".newsSilder");

        $indexBanner.slick({
            dots: true,
            infinite: true,
            fade: true,
            autoplay: true,
            arrows: false,
			focusOnSelect:true,
            speed: 1000,
            autoplaySpeed: 3500,
            adaptiveHeight: true
        }); //end slick

        $newsSilder.slick({
            dots:  false,
            infinite: true,
            autoplay: true,
            arrows: true,
			focusOnSelect:true,
            speed: 800,
            autoplaySpeed: 3500
        }); //end slick

    });//end each

    /* ============================================
        產品資訊
    ===============================================*/
    var $Pro = $("#Pro.detail");
    $Pro.each(function () {

        var $maximage = $Pro.find("#maximage"),
            $table = $Pro.find("#table1");

        $maximage.maximage({
            fillElement: '.bx-wrapper',
            backgroundSize: 'contain',
            cycleOptions: {
                fx: 'fade',
                //sync: false,
                autoplay: false,
                speed: 800, 
                timeout: 0,
                pause: 1,
                pager: '#cycle-nav ul',
                pagerAnchorBuilder: function(idx, slide) {
                    var imgsrc = jQuery.Slides[idx].url;
                    return '<li alt="' + imgsrc + '"><a href="#" rel="nofollow"><img src=' + imgsrc + ' width="50" /></a></li>';
                }
            },
            onFirstImageLoaded: function() {
                $maximage.fadeIn('fast');
            }
        });

        $table.responsiveTable({
            staticColumns: 1,
            scrollRight: true,
            scrollHintEnabled: true
        });    

    });//end each
        
    /*==================================================
       News
    =====================================================*/
    var $NewsList = $("#News.list");

    $NewsList.each(function () {

        var $newsTable = $NewsList.find("#TradeShowTable");

        $newsTable.DataTable({
            "searching": false,
            responsive: true,
            "columnDefs": [
                {
                    "targets": [ 3 ],
					"ordering": false

                }
            ]    
        });
    });//end each
    /* ============================================
        Download
    ===============================================*/
    var $Download = $("#Download");
    $Download.each(function () {

        var $downTable = $Download.find("#downTable"),
            $downTableH = $downTable.outerHeight( true ),
            $selectEntries = $Download.find("#downTable_length select"),
            $sideBar = $Download.find(".sideBar"),
            $cssmenu = $Download.find("#cssmenu"),
            $content = $Download.find(".content"),
            $wp = $Download.find(".wp"),
            $typeImg = $Download.find(".typeImg"),
            $typePlay = $Download.find(".typePlay"),
            $inline = $Download.find(".line"),

            $winW = $(window).width();

        
        $('#cssmenu li.has-sub>a').on('click', function(){
            $(this).removeAttr('href');
            var element = $(this).parent('li');
            if (element.hasClass('open')) {
                element.removeClass('open');
                element.find('li').removeClass('open');
                element.find('ul').slideUp(200);
            }
            else {
                element.addClass('open');
                element.children('ul').slideDown(200);
            }
        });

     
		
    	function filterGlobal () {
        $downTable.DataTable(
		).search(
            $('#keywords').val()
            ).draw();
        }

        $('#downloadSearch').submit(function () {
            return false;
        });

        $('#keywords').keyup( function() {
            //alert('test');
            filterGlobal ();
        } );

    
        $(window).resize(function() {

            $winW = $(window).width();  
            console.log($winW);    
       
            if ( $winW < 1180) {
                $wp.attr('id', 'sb-site');
                $content.css("height", 'auto');
            } else{

                setTimeout(function() {

                    var $contentH = $content.height(),
                        $sideBarH = $sideBar.outerHeight(true);
                    console.log( "$contentH:" + $contentH + " ,$sideBarH:" + $sideBarH );
                    if ( $contentH > $sideBarH  ) {
                        $sideBar.css("height", $contentH);
                    }
                }, 400);

            }
        }).resize();


        $typeImg.fancybox({
            helpers: {
              title : {
                  type : 'float'
              }
          }
        });

        $typePlay.fancybox({
            helpers : {
                media : {}
            }
        });

        $.slidebars({
            scrollLock: true
        });

    });//end each
    /* ============================================
       SupportForm
    ===============================================*/
    var $SupportForm = $("#SupportForm");
    $SupportForm.each(function () {

        var $inline = $SupportForm.find(".inline");

        $inline.fancybox({
            maxWidth    : 540,
            maxHeight   : 175,
            fitToView   : false,
            autoSize    : false,
            padding : 0
        });

    });//end each    
    
    /*==================================================
       Contact
    =====================================================*/
    var $Contact = $("#Contact");
    $Contact.each(function () {

        var $inline =$Contact.find(".inline"),
            $concel =$Contact.find(".ConcelLink"),
            $NewsOrder =$Contact.find(".NewsOrder"),
            $ConcelOrder =$Contact.find(".ConcelOrder");

        $inline.fancybox({
            maxWidth    : 525,
            width : "100%",
            maxHeight   : 340,
            fitToView   : false,
            autoSize    : false,
            padding : 0
        });

        $inline.click(function(){
            $NewsOrder.fadeIn();
            $ConcelOrder.fadeOut();
        });

        $concel.click(function(){
            $NewsOrder.fadeOut();


            setTimeout(function(){
                $ConcelOrder.fadeIn();
            }, 400);
        });

    });//end each

    /*==================================================
      Solutions
    =====================================================*/
    var $Solutions = $("#Solutions");
    $Solutions.each(function () { 

        var $bg = $Solutions.find(".bg"),
            $bgbody = $Solutions.find(".bgbody"),
            $lia = $Solutions.find(".og-grid > li > a"),
            $liH = $lia.height() + 50, //加上下 
            $expander = $Solutions.find(".og-expander");

            $expander.fadeOut();

        $(window).bind('scroll', function(){
            var $this = $(this);
            var $this_Top=$this.scrollTop();
                  
            if($this_Top < 80){     
                    $bg.stop().removeClass("has");
                    $bgbody.stop().removeClass("has");
            } else {
                $bg.stop().addClass("has");
                $bgbody.stop().addClass("has");
            }             
        }).scroll();

            $lia.click(function () {

                event.preventDefault()

                var $this = $(this);
                $expander.fadeOut(100);
   
                //console.log( "$liH:"+$liH );
                //get img height
                
                if ($this.parents("li").hasClass('actived')) {
                    $expander.fadeOut(300);
                    $this.parents("li").removeClass("actived");
                    $this.parents("ul").children("li").css("height",$liH );
                    return false;
                }
                $this.parents("ul").children().removeClass("actived");
                $this.parents("ul").children().css("height", $liH);
                $this.parents("li").addClass("actived");
                $this.parents("li").find(".og-expander").fadeIn(300);
                
                var tatleH = $this.next("div.og-expander").height() +$liH ;
                $this.parents("li.actived").css("height", tatleH);
            });

            $('.og-grid > li .og-close').click(function () {
                var $this = $(this);
                $expander.fadeOut(100);
                $this.parents("li").removeClass("actived");
                $this.parents("ul").children("li").css("height",$liH );

            });
            
    });//end each

    var Tabs = {

          init: function() {
            this.bindUIfunctions();
            this.pageLoadCorrectTab();
          },

          bindUIfunctions: function() {
            // Delegation
            $(document)
              .on("click", ".transformer-tabs a[href^='#']:not('.active')", function(event) {
                Tabs.changeTab(this.hash);
                event.preventDefault();
              })
              .on("click", ".transformer-tabs a.active", function(event) {
                Tabs.toggleMobileMenu(event, this);
                event.preventDefault();
              });
          },

          changeTab: function(hash) {
            var anchor = $("[href=" + hash + "]");
            var div = $(hash);

            // activate correct anchor (visually)
            anchor.addClass("active").parent().siblings().find("a").removeClass("active");

            // activate correct div (visually)
            div.addClass("active").siblings().removeClass("active");
            anchor.closest("ul").removeClass("open");

          },

          // If the page has a hash on load, go to that tab
          pageLoadCorrectTab: function() {
            this.changeTab(document.location.hash);
          },

          toggleMobileMenu: function(event, el) {
            $(el).closest("ul").toggleClass("open");
          }

        }

        Tabs.init();



/*document END*/
});


